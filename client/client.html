<html>

<head>
    <title>Personal Soundtrack</title>
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=PT+Sans:wght@700&family=Raleway:wght@200&display=swap" rel="stylesheet"> 
    <link href="default-styles.css" type="text/css" rel="stylesheet" />
</head>

<body>
    <header>
        <h1>Personal Soundtrack</h1>
        <nav>
            <a href="/home.html">Home</a>
            <a href="/client.html">App</a>
            <a href="/suggest.html">Suggest</a>
            <a href="/admin.html">Admin</a>
        </nav>
    </header>

    <main>
        <span id="time-span"></span>
        <img class="backgroundElement" id="sun" src="/images/sun">
        <img class="backgroundElement" id="moon" src="/images/moon">
        <audio id="musicPlayer" controls autoplay>
            <source src="/music/test.mp3" type="audio/mpeg">
            Your browser does not support the audio tag.
        </audio>
    </main>
    <footer>
        <p>by Jimmie Harkins</p>
    </footer>
    <script src='visual-effects.js'></script>
    <script>
        const timeSpan = document.querySelector("#time-span");
        const musicPlayer = document.querySelector("#musicPlayer");
        const musicSource = document.querySelector("#musicPlayer source");
        const songs = ["test", "paper-tigers", "west-coast-friendship"];
        let songIndex = 0;
        const updateTime = () => {
            const currentTime = new Date();
            const hours = currentTime.getHours();
            let minutes = currentTime.getMinutes();
            setVisualTime(hours + minutes / 60);
            if(minutes < 10) {
                minutes = "0" + minutes;
            }
            //creative use of ternary, if hours % 12 is 0, show 12 instead of 0
            let timeString = (hours % 12 ? hours % 12 : 12) + ":" + minutes + " ";
            if(hours > 11) {
                timeString += "PM";
            } else {
                timeString += "AM";
            }
            timeSpan.innerHTML = timeString;
        }
        const switchAudio = (e) => {
            songIndex++;
            musicSource.src = "/music/" + songs[songIndex % songs.length] + ".mp3";
            musicPlayer.load();
            musicPlayer.currentTime = 0;
        }
        musicPlayer.addEventListener('ended', switchAudio);
        updateTime();
        setInterval(updateTime, 1000);
    </script>
</body>

</html>